import{createContext as fe,useContext as de,useState as X,useEffect as ge,useCallback as I}from"react";var O={necessary:["security_storage"],functional:["functionality_storage","personalization_storage"],analytics:["analytics_storage"],marketing:["ad_storage","ad_user_data","ad_personalization"]},B={cookieName:"cc_consent",cookieDomain:"",cookieExpiry:365,consentVersion:"1",gtmId:""},E={necessary:!0,functional:!1,analytics:!1,marketing:!1},c={...B},a=null,x="hidden",R=new Set,D=new Set,P=!1,g=typeof window<"u";function L(){g&&(window.dataLayer=window.dataLayer||[],typeof window.gtag!="function"&&(window.gtag=function(){window.dataLayer.push(arguments)}))}function w(e){L();let t={};for(let[n,s]of Object.entries(O)){let o=e[n];for(let d of s)t[d]=o?"granted":"denied"}window.gtag("consent","default",t)}function ie(e,t){L();let n={};for(let[s,o]of Object.entries(O)){let d=e[s];for(let p of o)n[p]=d?"granted":"denied"}window.gtag("consent","update",n),window.dataLayer.push({event:"consent_update",consent_action:t,consent_categories:{...e}})}function ce(){if(!g)return null;let e=document.cookie.match(new RegExp(`(?:^|; )${c.cookieName}=([^;]*)`));if(!e)return null;try{return JSON.parse(decodeURIComponent(e[1]))}catch{return null}}function z(e){if(!g)return;let t=encodeURIComponent(JSON.stringify(e)),n=[`${c.cookieName}=${t}`,"path=/",`max-age=${c.cookieExpiry*86400}`,"SameSite=Lax"];c.cookieDomain&&n.push(`domain=${c.cookieDomain}`),location.protocol==="https:"&&n.push("Secure"),document.cookie=n.join("; ")}function le(){if(!g)return;let e=[`${c.cookieName}=`,"path=/","max-age=0","SameSite=Lax"];c.cookieDomain&&e.push(`domain=${c.cookieDomain}`),document.cookie=e.join("; ")}function ue(e){if(a)for(let t of R)try{t(a,e)}catch{}}function Ce(){for(let e of D)try{e(x)}catch{}}function f(e){x!==e&&(x=e,Ce())}function M(e={}){if(!g)return null;c={...B,...e},L();let t=!!navigator.globalPrivacyControl,n=ce();if(t&&!n){let o={...E,necessary:!0};return a={categories:o,consentVersion:c.consentVersion,timestamp:new Date().toISOString(),gpc:!0},w(o),z(a),P=!0,f("hidden"),a}if(n&&n.consentVersion===c.consentVersion)return a=n,w(n.categories),P=!0,f("hidden"),a;let s={...E};return w(s),a=null,P=!0,f("banner"),null}function $(){return x}function q(){return a?a.consentVersion===c.consentVersion:!1}function A(e,t="custom"){if(!g)throw new Error("updateConsent requires a browser environment");let n={necessary:!0,functional:e.functional??!1,analytics:e.analytics??!1,marketing:e.marketing??!1};return a={categories:n,consentVersion:c.consentVersion,timestamp:new Date().toISOString(),gpc:!!navigator.globalPrivacyControl},z(a),ie(n,t),ue(t),f("hidden"),{...a,categories:{...n}}}function H(){return A({necessary:!0,functional:!0,analytics:!0,marketing:!0},"accept_all")}function F(){return A({necessary:!0,functional:!1,analytics:!1,marketing:!1},"reject_all")}function G(){le(),a=null,g&&w(E),f("banner")}function K(e){return R.add(e),()=>{R.delete(e)}}function J(e){return D.add(e),()=>{D.delete(e)}}function W(){f("banner")}function Y(){f("preferences")}function Q(){f("hidden")}import{jsx as ye}from"react/jsx-runtime";var Z=fe(null);function pe({config:e,children:t}){let[n,s]=X(()=>M(e)),[o,d]=X(()=>$());ge(()=>{let l=K(C=>{s({...C,categories:{...C.categories}})}),y=J(C=>{d(C)});return()=>{l(),y()}},[]);let p=I(()=>{let l=H();s(l)},[]),h=I(()=>{let l=F();s(l)},[]),U=I(l=>{let y=A(l,"custom");s(y)},[]),k=I(()=>{G(),s(null)},[]),T={consent:n,uiState:o,hasConsent:q(),acceptAll:p,rejectAll:h,updateConsent:U,resetConsent:k,showBanner:W,showPreferences:Y,hideUI:Q};return ye(Z.Provider,{value:T,children:t})}function _(){let e=de(Z);if(!e)throw new Error("useCookieConsent must be used within a CookieConsentProvider");return e}import{useState as me,useEffect as ee,useRef as ne,useCallback as te}from"react";import{jsx as r,jsxs as u}from"react/jsx-runtime";var ke={title:"We value your privacy",description:"We use cookies to enhance your browsing experience, serve personalised content, and analyse our traffic. You can choose which cookies to allow.",acceptAll:"Accept All",rejectAll:"Reject All",customize:"Customize",savePreferences:"Save Preferences",backToNotice:"Back",functional:"Functional",functionalDescription:"Enable enhanced functionality and personalisation.",analytics:"Analytics",analyticsDescription:"Help us understand how visitors interact with our website.",marketing:"Marketing",marketingDescription:"Used to deliver relevant ads and track campaigns.",necessary:"Necessary",necessaryDescription:"Essential for the website to function. Always enabled."},be={position:"fixed",bottom:0,left:0,right:0,zIndex:999999};function he({labels:e,className:t}){let n={...ke,...e},{consent:s,uiState:o,acceptAll:d,rejectAll:p,updateConsent:h,showPreferences:U,showBanner:k,hideUI:T}=_(),[l,y]=me({functional:!1,analytics:!1,marketing:!1}),C=ne(null),v=ne(null);ee(()=>{o==="preferences"&&(y({functional:s?.categories.functional??!1,analytics:s?.categories.analytics??!1,marketing:s?.categories.marketing??!1}),v.current=document.activeElement),o==="hidden"&&v.current&&(v.current.focus(),v.current=null)},[o,s]),ee(()=>{if(o!=="preferences"||!C.current)return;let i=C.current,b='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';function N(m){if(m.key==="Escape"){k();return}if(m.key!=="Tab")return;let S=i.querySelectorAll(b);if(S.length===0)return;let V=S[0],j=S[S.length-1];m.shiftKey&&document.activeElement===V?(m.preventDefault(),j.focus()):!m.shiftKey&&document.activeElement===j&&(m.preventDefault(),V.focus())}return i.addEventListener("keydown",N),i.querySelector(b)?.focus(),()=>i.removeEventListener("keydown",N)},[o,k]);let oe=te(i=>{y(b=>({...b,[i]:!b[i]}))},[]),se=te(()=>{h(l)},[l,h]);if(o==="hidden")return null;let re=o==="banner",ae=o==="preferences";return u("div",{role:"dialog","aria-label":"Cookie consent","aria-modal":"false",style:be,className:t,children:[re&&u("div",{"data-cc":"notice",children:[r("p",{children:r("strong",{children:n.title})}),r("p",{children:n.description}),u("div",{children:[r("button",{type:"button",onClick:d,children:n.acceptAll}),r("button",{type:"button",onClick:p,children:n.rejectAll}),r("button",{type:"button",onClick:U,children:n.customize})]})]}),ae&&u("div",{"data-cc":"preferences-panel",ref:C,children:[r("button",{type:"button",onClick:k,children:n.backToNotice}),u("div",{children:[u("label",{children:[r("input",{type:"checkbox",checked:!0,disabled:!0}),r("strong",{children:n.necessary})]}),r("p",{children:n.necessaryDescription})]}),["functional","analytics","marketing"].map(i=>u("div",{children:[u("label",{children:[r("input",{type:"checkbox",checked:l[i],onChange:()=>oe(i)}),r("strong",{children:n[i]})]}),r("p",{children:n[`${i}Description`]})]},i)),u("div",{children:[r("button",{type:"button",onClick:se,children:n.savePreferences}),r("button",{type:"button",onClick:p,children:n.rejectAll})]})]})]})}export{he as CookieConsent,pe as CookieConsentProvider,_ as useCookieConsent};
//# sourceMappingURL=index.js.map
